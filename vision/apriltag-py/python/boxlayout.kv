#:import checkerboard part1_checkerboard
#:import tagcalib part2_tag_calib
WindowManager:
	FirstWindow:
	InputWindow:
	ProgressWindow:


<FirstWindow>
	name: "first"

	BoxLayout:
		size: root.width, root.height
		padding: 50
		spacing: 10
		orientation: "vertical"

		Label: 
			font_size: 90
			font_name: "RobotoMono-Regular"
			color: (1, 1, 1, 1)
			text: "Calibration"
			background_color: (23/255, 37/255, 41/255, 1)
			pos_hint: {'center_x': 0.5}
			size_hint: (1, 0.2)
			canvas.before:
				Color:
					rgba: self.background_color
				Rectangle:
					size: self.size
					pos: self.pos
			color: (1, 1, 1, 1)

		Label: 
			font_size: 40
			font_name: "RobotoMono-Regular"
			color: (1, 1, 1, 1)
			text_size: root.width, root.height
			valign: "center"
			halign: "center"
			text: "Please have a printed checkerboard ready for calibration."
			background_color: (23/255, 37/255, 41/255, 1)
			pos_hint: {'center_x': 0.5}
			size_hint: (1, 1)
			canvas.before:
				Color:
					rgba: self.background_color
				Rectangle:
					size: self.size
					pos: self.pos
			color: (1, 1, 1, 1)					

		RoundedButton:
			font_size: 80
			font_name: "RobotoMono-Regular"
			background_color: (240/255, 116/255, 112/255,1)
			color: (1, 1, 1, 1)
			text: "Start"
			pos_hint: {'center_x': 0.5}
			size_hint: (0.5, 0.2)
			on_release: 
				app.root.current = "input"
			


<InputWindow>
	name: "input"

	FloatLayout:
		Label:
			id: rows
			markup: True
			pos_hint: {'center_x': 0.45, 'center_y': 0.9}
			font_size: 60
			font_name: "RobotoMono-Regular"
			color: (1, 1, 1, 1)
			text: "[b]Number of Rows[/b]: "

		TextInput:
			id: rowsInput
			multiline: False
			input_filter: 'int'
			pos_hint: {'center_x': 0.63, 'center_y': 0.9}
			size_hint_y: None
			height: 60
			size_hint_x: None
			width: 100
			font_size: 37
			font_name: "RobotoMono-Regular"
			color: (1, 1, 1, 1)

		Label:
			id: columns
			markup: True
			pos_hint: {'center_x': 0.425, 'center_y': 0.8}
			font_size: 60
			font_name: "RobotoMono-Regular"
			color: (1, 1, 1, 1)
			text: "[b]Number of Columns[/b]: "

		TextInput:
			id: columnsInput
			multiline: False
			pos_hint: {'center_x': 0.63, 'center_y': 0.8}
			size_hint_y: None
			height: 60
			size_hint_x: None
			width: 100
			font_size: 37
			font_name: "RobotoMono-Regular"
			color: (1, 1, 1, 1)

		RoundedButton:
			id: calibrationButton
			font_size: 80
			font_name: "RobotoMono-Regular"
			color: (1, 1, 1, 1)
			background_color: (240/255, 116/255, 112/255,1)
			pos_hint: {'center_x': 0.8, 'center_y': 0.2}
			size_hint: (0.4, 0.1)
			text: "Begin"
			on_press:
				app.root.current: "progress"
				root.handle_input(rowsInput.text,columnsInput.text, fileCalibrationChooser.selection, filePositionChooser.selection)
		RoundedButton:
			id: backButton
			font_size: 80
			font_name: "RobotoMono-Regular"
			color: (1, 1, 1, 1)
			background_color: (240/255, 116/255, 112/255,1)
			pos_hint: {'center_x' : 0.2, 'center_y': 0.2}
			size_hint: (0.4, 0.1)
			text: "Back"
			on_release:
				app.root.current = "first"

				


		RoundedButton:
			id: calibrationChooser
			canvas.before:
				Color:
					rgba: (0,1/255,1/255,1)
				RoundedRectangle:
					size: self.size
					pos: self.pos
					radius: [10]
			font_size: 20
			font_name: "RobotoMono-Regular"
			pos_hint: {'center_x': 0.5, 'center_y': 0.55}
			size_hint: (0.2, 0.1)
			text: "Select Calibration File"
			on_press: root.showCalibrationChooser = not root.showCalibrationChooser

		RoundedButton:
			id: positionChooser
			canvas.before:
				Color:
					rgba: (0,1/255,1/255,1)
				RoundedRectangle:
					size: self.size
					pos: self.pos
					radius: [10]
			font_size: 20
			font_name: "RobotoMono-Regular"
			pos_hint: {'center_x': 0.5, 'center_y': 0.4}
			size_hint: (0.2, 0.1)
			text: "Select Position File"
			on_press: root.showPositionChooser = not root.showPositionChooser
			
	BoxLayout:
		#layout for the FileChooser
		orientation: 'vertical'
		size_hint_y: 1 if root.showCalibrationChooser else 0
		size_hint_x: 1 if root.showCalibrationChooser else 0
		pos_hint: {'center_x': 0.5, 'center_y': 0.5} if root.showCalibrationChooser else {'center_x': -1, 'center_y': -1}
		FileChooserListView:
			id: fileCalibrationChooser
			canvas.before:
				Color:
					rgba: 23/255, 37/255, 41/255, 1
				Rectangle:
					pos: self.pos
					size: self.size
				#on_selection: root.file_fire_select(*args)
			RoundedButton:
				id: test
				canvas.before:
					Color:
						rgba: 140/255, 60/255, 60/255, 1
					RoundedRectangle:
						size: self.size
						pos: self.pos
						radius: [10]
				font_size: 40
				pos_hint: {'center_x': 0.5, 'center_y': 0.955}
				size_hint: (0.1, 0.05)
				text: "Exit"
				on_press: root.showCalibrationChooser = not root.showCalibrationChooser
	BoxLayout:
		#layout for the FileChooser
		orientation: 'vertical'
		size_hint_y: 1 if root.showPositionChooser else 0
		size_hint_x: 1 if root.showPositionChooser else 0
		pos_hint: {'center_x': 0.5, 'center_y': 0.5} if root.showPositionChooser else {'center_x': -1, 'center_y': -1}
		FileChooserListView:
			id: filePositionChooser
			canvas.before:
				Color:
					rgba: 23/255, 37/255, 41/255, 1
				Rectangle:
					pos: self.pos
					size: self.size
				#on_selection: root.file_fire_select(*args)
			RoundedButton:
				id: test
				canvas.before:
					Color:
						rgba: 140/255, 60/255, 60/255, 1
					RoundedRectangle:
						size: self.size
						pos: self.pos
						radius: [10]
				font_size: 40
				pos_hint: {'center_x': 0.5, 'center_y': 0.955}
				size_hint: (0.1, 0.05)
				text: "Exit"
				on_press: root.showPositionChooser = not root.showPositionChooser


		#FileChooser: 
		#	id: fc
		#	FileChooserIconLayout
		#	FileChooserListLayout

<ProgressWindow>
	name: "progress"
	FloatLayout:

		


		






<RoundedButton@Button>
	background_color: (0,0,0,0)
	background_normal: ''
	canvas.before:
		Color:
			rgba: (0,139/255,139/255,1)
		RoundedRectangle:
			size: self.size
			pos: self.pos
			radius: [40]